<div class="flex flex-col items-center">
  <main class="px-4 sm:px-6 max-w-7xl pb-10">
    <div class="flex items-baseline justify-between border-gray-200 pb-6 pt-24">
      <h1 class="text-4xl font-bold text-white">Products</h1>

      <div class="flex items-center">
        <div>
          <button mat-button [matMenuTriggerFor]="sortMenu">Sort</button>
          <mat-menu #sortMenu="matMenu">
            <button (click)="handleSingleSelectFilter('price_high', 'sort')" mat-menu-item>
              Price: high-low
            </button>
            <button (click)="handleSingleSelectFilter('price_low', 'sort')" mat-menu-item>
              Price: low-high
            </button>
          </mat-menu>
        </div>
      </div>
    </div>
    <mat-divider></mat-divider>
    <!-- Products -->
    <section class="pt-6">
      <div class="grid grid-cols-2 gap-8 gap-y-10 lg:grid-cols-6">
        <div>
          <div class="flex items-start justify-between">
            <p class="text-lg">Filters</p>
            <mat-icon>filter_list</mat-icon>
          </div>
          <form class="hidden lg:block" action="">
            <cdk-accordion class="example-accordion">
              <div *ngFor="let item of filterData; index as i; let last = last">
                <div class="border-b border-gray-200 py-6">
                  <cdk-accordion-item #accordionItem="cdkAccordionItem" class="example-accordion-item" role="button"
                    tabindex="0" [attr.id]="'accordion-header-' + i" [attr.aria-expanded]="accordionItem.expanded"
                    [attr.aria-controls]="'accordion-body-' + i" (click)="accordionItem.toggle()">
                    <div class="example-accordion-item-header">
                      {{ item.name }}
                      <span class="example-accordion-item-description justify-self-end">
                        +
                      </span>

                      <div class="pt-6" id="filter-section-0">
                        <div class="scroll-py-4 example-accordion-item-body" role="region"
                          [style.display]="accordionItem.expanded ? '' : 'none'" [attr.id]="'accordion-body-' + i"
                          [attr.aria-labelledby]="'accordion-header-' + i">
                          <div *ngFor="let option of item.options">
                            <div class="flex items-center">
                              <mat-checkbox id="'filter - '+ option.value" [name]="item.id" [value]="option.value"
                                (click)="
                                  handleSingleSelectFilter(
                                    option.value,
                                    item.id
                                  )
                                ">
                                <span class="text-sm text-gray-500">
                                  {{ option.label }}
                                </span>
                              </mat-checkbox>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </cdk-accordion-item>
                </div>
                <mat-divider *ngIf="!last"></mat-divider>
              </div>
            </cdk-accordion>
            <cdk-accordion class="example-accordion">
              <div *ngFor="let item of singleFilter; index as i; let last = last">
                <div class="border-b border-gray-200 py-6">
                  <cdk-accordion-item #accordionItem="cdkAccordionItem" class="example-accordion-item" role="button"
                    tabindex="0" [attr.id]="'accordion-header-' + i" [attr.aria-expanded]="accordionItem.expanded"
                    [attr.aria-controls]="'accordion-body-' + i">
                    <div class="example-accordion-item-header font-medium" (click)="accordionItem.toggle()">
                      {{ item.name }}
                      <span class="example-accordion-item-description justify-self-end">
                        +
                      </span>

                      <div class="pt-6" id="filter-section-0">
                        <div class="scroll-py-4 example-accordion-item-body" role="region"
                          [style.display]="accordionItem.expanded ? '' : 'none'" [attr.id]="'accordion-body-' + i"
                          [attr.aria-labelledby]="'accordion-header-' + i">
                          <div *ngFor="let option of item.options">
                            <div class="flex items-center">
                              <mat-radio-button id="'filter - '+ option.value'" [name]="item.id" [value]="option.value">
                                <span class="text-sm text-gray-500">
                                  {{ option.label }}
                                </span>
                              </mat-radio-button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </cdk-accordion-item>
                </div>
                <mat-divider *ngIf="!last"></mat-divider>
              </div>
            </cdk-accordion>
          </form>
        </div>

        <div class="lg:col-span-5" #scrollContainer>
          <div class="flex flex-wrap justify-evenly">
            <!-- Loading spinner -->
            <div *ngIf="loading">
              <mat-spinner></mat-spinner>
              <p>Loading...</p>
            </div>

            <ng-container *ngIf="allProducts$ | async as allProducts">
              <div *ngFor="let product of allProducts">
                <app-product-card [product]="product"></app-product-card>
              </div>
            </ng-container>
          </div>
        </div>
      </div>
    </section>
  </main>
</div>